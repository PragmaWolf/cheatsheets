**[Вопросы собеседований](../../README.md#tasks) ::** 
**[JavaScript](../../README.md#tasks-javascript) ::**
# Порядок выполнения 2 (Promise и setTimeout)

Дан следующий скрипт:
```javascript
console.log(1);
setTimeout(() => console.log(2));
Promise.reject(3).catch(console.log);
new Promise(resolve => setTimeout(resolve)).then(() => console.log(4));
Promise.resolve(5).then(console.log);
console.log(6);
setTimeout(()=> console.log(7), 0);
```
Опишите каков будет вывод этого скрипта в консоли, после исполнения и почему.

[К оглавлению](../../README.md#tasks-javascript)

---

## Решение
Вывод в консоли будет следующим:
```
1
6
3
5
2
4
7
```
**Код выполняется так:**
- сначала отрабатывает синхронный код;
- затем отрабатываются существующие микротаски (Promise) (если они есть);
- затем обрабатываются макротаски (setTimeout);
- если после отработки макротаски появляются микротаски, то обрабатываются они, иначе обработка переходит к следующей макротаске.

**Описание порядка выполнения и вывода**
1. Сначала выведется `1` и `6`, потому что сначала отработается синхронный код и будут показаны результаты `console.log(1)` и `console.log(6)`.
1. Теперь будут обработаны микротаски.
1. Выведется `3` - это обрабатывается первый Promise - `Promise.reject(3).catch(console.log)`.
1. Обрабатывается `new Promise(resolve => setTimeout(resolve))`, но он порождает макротаску `setTimeout` от выполнения которой зависит завершение этой микротаски, так что выполнение откладывается до выполнения порожденной макротаски. Здесь сейчас ничего выведено не будет.
1. Затем выведется `5` - обрабатывается третий Promise - `Promise.resolve(5).then(console.log)`.
1. Обработка микротасок закончена, начинается обработка макротасок.
1. Далее будет выведено `2` - результат первой макротаски `setTimeout(() => console.log(2))`.
1. Затем будет обработано `setTimeout(resolve)`, после чего исполнение будет передано микротаске.
1. Выведется `4` как результат завершения микротаски обработки Promise - `.then(() => console.log(4))`.
1. И наконец выведется `7` как результат обработки последней макротаски `setTimeout(()=> console.log(7), 0)`.

[К оглавлению](../../README.md#tasks-javascript)
