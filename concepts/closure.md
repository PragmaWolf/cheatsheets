**[Концепции, понятия, термины](../README.md#concepts) ::**
# Замыкание (Closure)

Различные методики передачи в функцию первого класса (она же `callback`) информации о переменных вне её тела. Способ представления функциональности и данных, связанных и упакованных вместе.

> :thinking: **AIUI**
>
> Самые простые варианты замыканий - каррирование или колбэки. Порождающая функция сохраняет данные в своем контексте, а порожденная функция их использует. Функция ссылается на переменные, не содержащиеся в её теле.

[К оглавлению](../README.md#concepts)

> [!IMPORTANT]
> Реализация и использование зависит от конкретного языка программирования.

Основное назначение - разделение ответственности между слоями кода: "библиотечная" функция готовит данные, функция с "пользовательского" слоя обрабатывает. Чтобы библиотека не теряла общность, "пользовательская" функция обязана иметь нейтральную сигнатуру, не выдающую, какими сторонними данными происходит обмен.

**Примерные сценарии:**
- при наступлении события вызвать пользовательскую функцию;
- обойти несколько объектов и для каждого вызвать пользовательскую функцию; 
- провести сортировку в пользовательском порядке.

**Состоит из**
- ссылки на функцию;
- пакета данных, показывающего, при каких обстоятельствах функцию вызвали (и наоборот, функция может модифицировать этот пакет, чтобы передать наружу, что случилось при её исполнении).

**Методики создания замыканий:**
- Глобальная переменная (теряется [реентерабельность](reentrant.md)).
- Дополнительный параметр, который гарантированно передаётся неизменным и позволяет упаковать небольшой объект или передать по ссылке большой.
- Объект с операцией "вызов", создаваемый каждый раз. Такой объект также может перехватывать локальные переменные и/или ссылаться на текущий объект `this`, связывая внутреннюю функцию с местом, где она определена в коде.

Чтобы разнотипные объекты можно было однообразно вызывать, существуют **несколько разных подходов**:
- они поддерживают один и тот же интерфейс;
- метапрограммирование;
- промежуточный объект, берущий тонкости типа на себя.
- нужные данные автоматически содержатся в любой ссылке на функцию;
- метод объекта вместе с указателем на сам объект.

[К оглавлению](../README.md#concepts)

> [!IMPORTANT]
> Если вы заметили ошибку, неточность, нехватку информации, пожалуйста, сообщите мне.
