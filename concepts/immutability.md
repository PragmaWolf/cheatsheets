**[Концепции, понятия, термины](../README.md#concepts) ::**
# Иммутабельность

Предполагает, что после создания данные или структура, которая их содержит, не могут быть изменены. Результатом любой модификации такого объекта всегда будет новый объект, при этом старый объект не изменится. 

> :thinking: **IMHO**
>
> При разработке надо понимать, может ли мутировать объект или нет в конкретном случае и как мутация этих данных отразится на всей программе или модулях. Помнить про память - для изменения иммутабельных объектов может потребоваться много памяти. Если предполагается много мутаций, то потом будет сложно среди новых объектов с мутациями найти нужный.

[К оглавлению](../README.md#concepts)

Иммутабельные данные - те, которые нельзя изменить. Примерно как числа - число просто есть, его нельзя поменять. Например, иммутабельный массив — он такой, каким его создали, и всегда таким будет. Если нужно добавить элемент — придется создать новый массив.

Иммутабельность может быть как полной, так и частичной. Можно запретить изменения всего объекта и всех его данных или же запретить частично, например, структура объекта не может меняться, но часть его данных - может.

Иммутабельность полезна в случаях, когда создаётся кусок данных (объект), который используется в нескольких местах и/или в разных потоках. Тогда вероятность того, что такой объект _внезапно_ поменяется, равна нулю. В частности, иммутабельный объект всегда потокобезопасен и [реентерабелен](reentrant.md) без дополнительных усилий. В отличие от мутабельных объектов.

Сильно зависит от подходов (например, функциональное или объектно-ориентированное программирование), от реализации языков и компиляторов. Иммутабельность может сделать программу более предсказуемой и простой для понимания и отладки.

Существует два типа мутаций (изменений) - видимые и невидимые: 
- **Видимые мутации** - это мутации, которые изменяют данные или структуру, через контролируемые внешним наблюдателем (пользователем) инструменты, например API.
- **Невидимые мутации** - изменения не контролируются внешним наблюдателем (пользователем). Данные изменения могут рассматриваться как сайд-эффекты (side-effects) функций и методов.

Плюсы:
- Гарантия сохранности данных.
- Проще хранение и отложенные вычисления.
- Безопасность использования.
- Быстрое отслеживание изменений при применении мутаций.
- При многопоточности избавляет от блокировок (можно безопасно разделять ссылку между потоками).
- Отсутствие сайд-эффектов возможных при мутациях.
- Легче читать и поддерживать код.
- Лучшая [инкапсуляция](encapsulation.md).

Минусы:
- Большой расход памяти при модификации иммутабельных объектов - создается новый объект с изменениями и остается храниться старый объект с данными.
- Сложность работы при необходимости мутировать данные.

[К оглавлению](../README.md#concepts)
